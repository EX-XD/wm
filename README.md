# 万门大学课程视频批量下载

## 使用步骤

### 编译

在任意操作系统安装 Go 后执行
``` shell
go build .
```
得到可执行文件。[Release](https://github.com/cildhdi/wm/releases) 中提供 Windows 平台可执行文件的下载。

### 安装

- 浏览器安装 Tampermonkey 插件
- Tampermonkey 添加脚本，贴入 `wm.js` 的内容

### 运行

#### 添加课程任务

运行上述可执行文件，输入 `1` 进入添加任务模式，然后在浏览器打开任意的课程页面，加载完毕后点击左边添加课程按钮，输入课程名称（会以此名称在wm同级download文件夹内新建文件夹），在 wm 控制台会显示相关信息请关注。成功之后可以关闭 wm。

#### 开始下载 m3u8 文件
再次运行上述可执行文件，输入 `2` 进入分发任务模式，浏览器打开任意多的万门课程标签页后自动开始刷新下载。在 wm 控制台会显示相关信息请关注。

#### 下载视频
使用 [m3u8批量下载](https://nilaoda.github.io/N_m3u8DL-CLI/SimpleGUI.html) 工具，将 download 文件夹内的课程名文件夹拖放到下载工具的M3U8地址文本框，BASEURL填入

https://media.wanmen.org/

点击 Go 开始下载。

### TIP
- 有关标签页的数量，一个标签页刷新一次即获取到一个视频链接，理论上打开越多获取越快，但刷新速度受网速以及设备性能的限制，请根据实际情况自行调整打开数量。
- wm同级目录下的 wm.db 保存了课程任务信息，在退出后再次进入分发任务模式，可以自动开始上次未完成的任务。